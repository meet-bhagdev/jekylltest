<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="shortcut icon" type="image/png" href="https://upload.wikimedia.org/wikipedia/commons/thumb/4/44/Microsoft_logo.svg/2000px-Microsoft_logo.svg.png">

  <title>
    
      Python Windows
    
  </title>
  <meta name="description" content="Get started with SQL Server on macOS, Linux, and Windows.">
  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="http://localhost:4000/python/windows/step/3">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-62780441-15', 'auto');
  ga('send', 'pageview');
  $(document).ready(function() {
      $("code").bind({
          copy: function(event) {
              ga("send", "event", {
                  eventCategory: window.location.pathname,
                  eventAction: "copy_code"
              });
         console.log("Copy");

          }, 

          cut: function(event) {
              ga("send", "event", {
                  eventCategory: window.location.pathname,
                  eventAction: "copy_code"
              });
          }
      })

      $("a").click(function(event) {
          ga("send", "event", {
              eventCategory: window.location.pathname,
              eventAction: "click_link",
              eventLabel: event.target.href
          });
      })
  });  
  </script>



</head>


  <body>

    <header class="sql-header sql-header--empty" role="banner">
    <div class="sql-header-content">
      <img class="sql-header-micro" src="/assets/images/micro-logo.png" alt="Microsoft logo">
      
        <div class="sql-menutop">
          <a class="sql-menutop-link" href="/">Get started with SQL Server</a>
          <div>
            
              
              

              <div class="sql-menutop-sub ">
                  
                    
                      
                      

                        
                          <span class="sql-menutop-link">C# </span>
                        

                        
                    
                      
                      

                        

                        
                          <div class="sql-menutop-items">
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/csharp/mac" 
                                target="_self">
                                macOS
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/csharp/rhel" 
                                target="_self">
                                RHEL
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/csharp/ubuntu" 
                                target="_self">
                                Ubuntu
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/csharp/windows" 
                                target="_self">
                                Windows
                                
                              </a>
                            
                          </div>
                        
                    
                  
              </div>
            
              
              

              <div class="sql-menutop-sub ">
                  
                    
                      
                      

                        
                          <span class="sql-menutop-link">Java </span>
                        

                        
                    
                      
                      

                        

                        
                          <div class="sql-menutop-items">
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/java/mac" 
                                target="_self">
                                macOS
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/java/rhel" 
                                target="_self">
                                RHEL
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/java/ubuntu" 
                                target="_self">
                                Ubuntu
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/java/sles" 
                                target="_self">
                                SLES
                                
                                  <i class="sql-new"></i>
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/java/windows" 
                                target="_self">
                                Windows
                                
                              </a>
                            
                          </div>
                        
                    
                  
              </div>
            
              
              

              <div class="sql-menutop-sub ">
                  
                    
                      
                      

                        
                          <span class="sql-menutop-link">Node.js </span>
                        

                        
                    
                      
                      

                        

                        
                          <div class="sql-menutop-items">
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/node/mac" 
                                target="_self">
                                macOS
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/node/rhel" 
                                target="_self">
                                RHEL
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/node/ubuntu" 
                                target="_self">
                                Ubuntu
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/node/sles" 
                                target="_self">
                                SLES
                                
                                  <i class="sql-new"></i>
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/node/windows" 
                                target="_self">
                                Windows
                                
                              </a>
                            
                          </div>
                        
                    
                  
              </div>
            
              
              

              <div class="sql-menutop-sub ">
                  
                    
                      
                      

                        
                          <span class="sql-menutop-link">PHP </span>
                        

                        
                    
                      
                      

                        

                        
                          <div class="sql-menutop-items">
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/php/mac" 
                                target="_self">
                                macOS
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/php/rhel" 
                                target="_self">
                                RHEL
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/php/ubuntu" 
                                target="_self">
                                Ubuntu
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/php/sles" 
                                target="_self">
                                SLES
                                
                                  <i class="sql-new"></i>
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/php/windows" 
                                target="_self">
                                Windows
                                
                              </a>
                            
                          </div>
                        
                    
                  
              </div>
            
              
              

              <div class="sql-menutop-sub  is-active ">
                  
                    
                      
                      

                        
                          <span class="sql-menutop-link">Python </span>
                        

                        
                    
                      
                      

                        

                        
                          <div class="sql-menutop-items">
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/python/mac" 
                                target="_self">
                                macOS
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/python/rhel" 
                                target="_self">
                                RHEL
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/python/ubuntu" 
                                target="_self">
                                Ubuntu
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/python/sles" 
                                target="_self">
                                SLES
                                
                                  <i class="sql-new"></i>
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item  is-active " 
                                href="/python/windows" 
                                target="_self">
                                Windows
                                
                              </a>
                            
                          </div>
                        
                    
                  
              </div>
            
              
              

              <div class="sql-menutop-sub ">
                  
                    
                      
                      

                        
                          <span class="sql-menutop-link">Ruby </span>
                        

                        
                    
                      
                      

                        

                        
                          <div class="sql-menutop-items">
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/ruby/mac" 
                                target="_self">
                                macOS
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/ruby/rhel" 
                                target="_self">
                                RHEL
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/ruby/ubuntu" 
                                target="_self">
                                Ubuntu
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/ruby/sles" 
                                target="_self">
                                SLES
                                
                                  <i class="sql-new"></i>
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/ruby/windows" 
                                target="_self">
                                Windows
                                
                              </a>
                            
                          </div>
                        
                    
                  
              </div>
            
          </div>
        </div>

      
</header>


    <main class="sql-main" aria-label="Content">
      <div class="u-wrapper">
        <article class="sql-page_steps">

  
    
    
    

    <h1 class="sql-page_steps-hero">
      Create Python apps using SQL Server on Windows
    </h1>

    <header class="sql-page_steps-steps js-stepsheader">
      
        
        

        <div class="sql-page_steps-step">
          
            <a class="sql-page_steps-link "
               href="/python/windows"
               target="_self">
               <span class="sql-page_steps-number">1</span>
               Set up your environment
              </a>
          
        </div>
      
        
        

        <div class="sql-page_steps-step">
          
            <a class="sql-page_steps-link "
               href="/python/windows/step/2"
               target="_self">
               <span class="sql-page_steps-number">2</span>
               Create Python application with SQL server
            </a>
          
        </div>
      
        
        

        <div class="sql-page_steps-step">
          
            <a class="sql-page_steps-link  sql-page_steps-link--active "
               href="/python/windows/step/3"
               target="_self">
               <span class="sql-page_steps-number">3</span>
               Make your Python app up to 100x faster
            </a>
          
        </div>
      
    </header>
  

  <div class="sql-page_steps-loading js-loading">
    <p></p>
    <p></p>
    <p></p>
    <p></p>
    <div></div>
    <div></div>
    <p></p>
    <div></div>
    <div></div>
    <p></p>
    <div></div>
    <div></div>
    <div></div>
    <div></div>
    <p></p>
    <p></p>
    <div></div>
    <div></div>
    <div></div>
    <p></p>
    <div></div>
    <div></div>
    <p></p>
    <p></p>
    <div></div>
    <div></div>
    
  </div>

  <div class="js-steps is-hidden">
    <blockquote>
  <p>Now that you have explored the basics, you are ready to see how you can make your app better with SQL Server. In this module we will show you a simple example of Columnstore Indexes and how they can improve data processing speeds. Columnstore Indexes can achieve up to 100x better performance on analytical workloads and up to 10x better data compression than traditional rowstore indexes.</p>
</blockquote>

<h2 id="step-31">Step 3.1</h2>
<p>Note! With the introduction of Service Pack 1 for SQL Server 2016, features in the database engine related to application development are now available across all editions of SQL Server (from Express through Enterprise). This includes innovations that can significantly improve your application’s throughput, latency, and security. Examples include the in-memory columnstore used in this tutorial, in-memory OLTP, data compression, table partitioning, Hadoop integration with PolyBase, Always Encrypted, row-level security, and data masking. Enjoy!</p>

<p>To showcase the capabilities of Columnstore indexes, let’s create a C# application that creates a sample database and a sample table with 5 million rows and then runs a simple query before and after adding a Columnstore index.</p>

<p><strong>Create a C# console application</strong></p>
<ol>
  <li>Launch Visual Studio Community</li>
  <li>Click <strong>File -&gt; New -&gt; Project</strong></li>
  <li>In the <strong>New project</strong> dialog, click <strong>Windows</strong> located under <strong>Visual C#</strong> in the <strong>Templates</strong> node</li>
  <li>Click <strong>Console Application Visual C#</strong></li>
  <li>Name the project “SqlServerColumnstoreSample”</li>
  <li>Click <strong>OK</strong> to create the project</li>
</ol>

<p>Visual Studio creates a new C# Console Application project and opens the file <strong>Program.cs</strong>. Replace the contents of <strong>Program.cs</strong> by copying and pasting the code below into the file. Don’t forget to replace the username and password with your own. Save and close the file.</p>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Data.SqlClient</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">SqlServerColumnstoreSample</span>
<span class="p">{</span>
    <span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>
        <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">try</span>
            <span class="p">{</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"*** SQL Server Columnstore demo ***"</span><span class="p">);</span>

                <span class="c1">// Build connection string
</span>                <span class="n">SqlConnectionStringBuilder</span> <span class="n">builder</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SqlConnectionStringBuilder</span><span class="p">();</span>
                <span class="n">builder</span><span class="p">.</span><span class="n">DataSource</span> <span class="p">=</span> <span class="s">"localhost"</span><span class="p">;</span>   <span class="c1">//  update me
</span>                <span class="n">builder</span><span class="p">.</span><span class="n">UserID</span> <span class="p">=</span> <span class="s">"sa"</span><span class="p">;</span>              <span class="c1">//  update me
</span>                <span class="n">builder</span><span class="p">.</span><span class="n">Password</span> <span class="p">=</span> <span class="s">"your_password"</span><span class="p">;</span>      <span class="c1">// update me
</span>                <span class="n">builder</span><span class="p">.</span><span class="n">InitialCatalog</span> <span class="p">=</span> <span class="s">"master"</span><span class="p">;</span>

                <span class="c1">// Connect to SQL
</span>                <span class="n">Console</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="s">"Connecting to SQL Server ... "</span><span class="p">);</span>
                <span class="k">using</span> <span class="p">(</span><span class="n">SqlConnection</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SqlConnection</span><span class="p">(</span><span class="n">builder</span><span class="p">.</span><span class="n">ConnectionString</span><span class="p">))</span>
                <span class="p">{</span>
                    <span class="n">connection</span><span class="p">.</span><span class="nf">Open</span><span class="p">();</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Done."</span><span class="p">);</span>

                    <span class="c1">// Create a sample database
</span>                    <span class="n">Console</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="s">"Dropping and creating database 'SampleDB' ... "</span><span class="p">);</span>
                    <span class="n">String</span> <span class="n">sql</span> <span class="p">=</span> <span class="s">"DROP DATABASE IF EXISTS [SampleDB]; CREATE DATABASE [SampleDB]"</span><span class="p">;</span>
                    <span class="k">using</span> <span class="p">(</span><span class="n">SqlCommand</span> <span class="n">command</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SqlCommand</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">connection</span><span class="p">))</span>
                    <span class="p">{</span>
                        <span class="n">command</span><span class="p">.</span><span class="nf">ExecuteNonQuery</span><span class="p">();</span>
                        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Done."</span><span class="p">);</span>
                    <span class="p">}</span>

                    <span class="c1">// Insert 5 million rows into the table 'Table_with_5M_rows'
</span>                    <span class="n">Console</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="s">"Inserting 5 million rows into table 'Table_with_5M_rows'. This takes ~1 minute, please wait ... "</span><span class="p">);</span>
                    <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>
                    <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"USE SampleDB; "</span><span class="p">);</span>
                    <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"WITH a AS (SELECT * FROM (VALUES(1),(2),(3),(4),(5),(6),(7),(8),(9),(10)) AS a(a))"</span><span class="p">);</span>
                    <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"SELECT TOP(5000000)"</span><span class="p">);</span>
                    <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"ROW_NUMBER() OVER (ORDER BY a.a) AS OrderItemId "</span><span class="p">);</span>
                    <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">",a.a + b.a + c.a + d.a + e.a + f.a + g.a + h.a AS OrderId "</span><span class="p">);</span>
                    <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">",a.a * 10 AS Price "</span><span class="p">);</span>
                    <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">",CONCAT(a.a, N' ', b.a, N' ', c.a, N' ', d.a, N' ', e.a, N' ', f.a, N' ', g.a, N' ', h.a) AS ProductName "</span><span class="p">);</span>
                    <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"INTO Table_with_5M_rows "</span><span class="p">);</span>
                    <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"FROM a, a AS b, a AS c, a AS d, a AS e, a AS f, a AS g, a AS h;"</span><span class="p">);</span>
                    <span class="n">sql</span> <span class="p">=</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">();</span>
                    <span class="k">using</span> <span class="p">(</span><span class="n">SqlCommand</span> <span class="n">command</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SqlCommand</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">connection</span><span class="p">))</span>
                    <span class="p">{</span>
                        <span class="n">command</span><span class="p">.</span><span class="nf">ExecuteNonQuery</span><span class="p">();</span>
                        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Done."</span><span class="p">);</span>
                    <span class="p">}</span>

                    <span class="c1">// Execute SQL query without columnstore index
</span>                    <span class="kt">double</span> <span class="n">elapsedTimeWithoutIndex</span> <span class="p">=</span> <span class="nf">SumPrice</span><span class="p">(</span><span class="n">connection</span><span class="p">);</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Query time WITHOUT columnstore index: "</span> <span class="p">+</span> <span class="n">elapsedTimeWithoutIndex</span> <span class="p">+</span> <span class="s">"ms"</span><span class="p">);</span>

                    <span class="c1">// Add a Columnstore Index
</span>                    <span class="n">Console</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="s">"Adding a columnstore to table 'Table_with_5M_rows'  ... "</span><span class="p">);</span>
                    <span class="n">sql</span> <span class="p">=</span> <span class="s">"CREATE CLUSTERED COLUMNSTORE INDEX columnstoreindex ON Table_with_5M_rows;"</span><span class="p">;</span>
                    <span class="k">using</span> <span class="p">(</span><span class="n">SqlCommand</span> <span class="n">command</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SqlCommand</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">connection</span><span class="p">))</span>
                    <span class="p">{</span>
                        <span class="n">command</span><span class="p">.</span><span class="nf">ExecuteNonQuery</span><span class="p">();</span>
                        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Done."</span><span class="p">);</span>
                    <span class="p">}</span>

                    <span class="c1">// Execute the same SQL query again after columnstore index was added
</span>                    <span class="kt">double</span> <span class="n">elapsedTimeWithIndex</span> <span class="p">=</span> <span class="nf">SumPrice</span><span class="p">(</span><span class="n">connection</span><span class="p">);</span>
				    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Query time WITH columnstore index: "</span> <span class="p">+</span> <span class="n">elapsedTimeWithIndex</span> <span class="p">+</span> <span class="s">"ms"</span><span class="p">);</span>

                    <span class="c1">// Calculate performance gain from adding columnstore index
</span>				    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Performance improvement with columnstore index: "</span>
						<span class="p">+</span> <span class="n">Math</span><span class="p">.</span><span class="nf">Round</span><span class="p">(</span><span class="n">elapsedTimeWithoutIndex</span> <span class="p">/</span> <span class="n">elapsedTimeWithIndex</span><span class="p">)</span> <span class="p">+</span> <span class="s">"x!"</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"All done. Press any key to finish..."</span><span class="p">);</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">ReadKey</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="nf">ToString</span><span class="p">());</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">static</span> <span class="kt">double</span> <span class="nf">SumPrice</span><span class="p">(</span><span class="n">SqlConnection</span> <span class="n">connection</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">String</span> <span class="n">sql</span> <span class="p">=</span> <span class="s">"SELECT SUM(Price) FROM Table_with_5M_rows"</span><span class="p">;</span>
            <span class="kt">long</span> <span class="n">startTicks</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">.</span><span class="n">Ticks</span><span class="p">;</span>
            <span class="k">using</span> <span class="p">(</span><span class="n">SqlCommand</span> <span class="n">command</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SqlCommand</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">connection</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="k">try</span>
                <span class="p">{</span>
                    <span class="kt">var</span> <span class="n">sum</span> <span class="p">=</span> <span class="n">command</span><span class="p">.</span><span class="nf">ExecuteScalar</span><span class="p">();</span>
                    <span class="n">TimeSpan</span> <span class="n">elapsed</span> <span class="p">=</span> <span class="n">TimeSpan</span><span class="p">.</span><span class="nf">FromTicks</span><span class="p">(</span><span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">.</span><span class="n">Ticks</span><span class="p">)</span> <span class="p">-</span> <span class="n">TimeSpan</span><span class="p">.</span><span class="nf">FromTicks</span><span class="p">(</span><span class="n">startTicks</span><span class="p">);</span>
                    <span class="k">return</span> <span class="n">elapsed</span><span class="p">.</span><span class="n">TotalMilliseconds</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="nf">ToString</span><span class="p">());</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="m">0</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Press <strong>F5</strong> to build and run your project.</p>

<pre><code class="language-results">*** SQL Server Columnstore demo ***
Connecting to SQL Server ... Done.
Dropping and creating database 'SampleDB' ... Done.
Inserting 5 million rows into table 'Table_with_5M_rows'. This takes ~1 minute, please wait ... Done.
Query time WITHOUT columnstore index: 363.09ms
Adding a columnstore to table 'Table_with_5M_rows'  ... Done.
Query time WITH columnstore index: 5.123ms
Performance improvement with columnstore index: 71x!
All done. Press any key to finish...
</code></pre>
<blockquote>
  <p>The performance of the query was greatly improved! 
Now that you’ve built a few C# apps with SQL Server and .NET Core, continue checking out other SQL Server features.</p>
</blockquote>

<h2 id="try-the-mssql-extension-for-visual-studio-code">Try the mssql extension for Visual Studio Code!</h2>
<p>Use the <strong>mssql</strong> extension for VS Code to connect to SQL Server running in Linux, Windows or Docker, Azure SQL DB and Azure SQL DW. … See more Get rich T-SQL language services (ex. IntelliSense and keyword completion), while typing queries and run your queries to see results – all within VS Code and on Linux, Mac and Windows.</p>

<p>Follow the steps <a href="https://docs.microsoft.com/en-us/sql/linux/sql-server-linux-develop-use-vscode">here</a> to install and use the <strong>mssql</strong> extension for VS Code.</p>

<p><img src="http://localhost:4000/assets/images/VSCode_Extension.png" alt="VSCode Extension" /></p>

  </div>

  
    
    

          
            <a class="sql-page_steps-next" href="https://github.com/mkleehammer/pyodbc">Check out the Python Driver pyodbc on GitHub</a>
          

      <div class="sql-resources">
    <header class="sql-resources-header">
        <h3 class="sql-resources-title">
            To get general documentations
        </h3>
        <a class="sql-resources-button"
            target="_blank"
            href="https://msdn.microsoft.com/en-us/library/mt590198(v=sql.1).aspx">
            Read the SQL Server documentation
        </a>
    </header>

    <div class="sql-resources-list">
        <h3 class="sql-resources-title">
            Check out other related tutorials and SQL Server features!
        </h3>
        
            <ul class="sql-resources-items">
                
                    
                    
                
                    
                    
                
                    
                    
                
                    
                    
                
                    
                    
                        <li class="sql-resources-item">
                            Check out what's new with <a class="sql-resources-link" href="https://channel9.msdn.com/Events/Connect/2016/189" target="_blank">SQL Server + Python on Channel 9</a>
                        </li>
                    
                
                    
                    
                        <li class="sql-resources-item">
                            Browse more SQL Server code samples (In-Memory, Dynamic Data Masking, R, etc.) on our <a class="sql-resources-link" href="https://github.com/Microsoft/sql-server-samples/tree/master/samples/" target="_blank">GitHub repository</a>
                        </li>
                    
                
                    
                    
                        <li class="sql-resources-item">
                            Learn more about <a class="sql-resources-link" href="https://channel9.msdn.com/Events/Connect/2016/101" target="_blank">SQL Server on Linux</a>
                        </li>
                    
                
                    
                    
                        <li class="sql-resources-item">
                            Watch more <a class="sql-resources-link" href="https://channel9.msdn.com/Events/Connect/2016" target="_blank">Connect(); event videos</a>
                        </li>
                    
                
                    
                    
                        <li class="sql-resources-item">
                            Browse our <a class="sql-resources-link" href="https://technet.microsoft.com/en-us/virtuallabs" target="_blank">Virtual Labs Gallery</a>
                        </li>
                    
                
            </ul>
      
    </div>
</div>
    
  

  <div class="sql-questions">
    <h2 class="sql-questions-title">
        Have Questions?
    </h2>
    <p class="sql-questions-text">
        Happy to help! You can find us on <a href="https://github.com/Microsoft/sql-server-samples/tree/master/samples/tutorials" target="_blank">GitHub</a>, <a href="https://social.msdn.microsoft.com/Forums/en-US/home target="_blank"">MSDN Forums</a>, and StackOverflow. We also monitor the <a href="https://twitter.com/search?q=%23SQLServerDev&amp;src=typd" target="_blank">#SQLServerDev</a> hashtag on Twitter.
    </p>
</div>

  
      <footer class="sql-disqus">
        

      </footer>
  
</article>

      </div>
    </main>

    <footer class="sql-footer">
  




    <div class="sql-footer-copy">
        <a class="sql-footer-link" href="https://go.microsoft.com/?linkid=2028325">Contact us</a> | 
        <a class="sql-footer-link" href="https://go.microsoft.com/fwlink/?LinkId=521839">Privacy & cookies</a> | 
        <a class="sql-footer-link" href="https://go.microsoft.com/fwlink/?LinkID=206977">Terms of use</a> | 
        <a class="sql-footer-link" href="https://www.microsoft.com/trademarks">Trademarks</a> | 
        <a class="sql-footer-link" href="https://choice.microsoft.com/">About our ads</a> | 
        © 2017 Microsoft 
      <!--
        <a href="#" target="_blank" class="sql-footer-icon fa fa-twitter" aria-hidden="true" style="float:right;"></a>
        <a href="#" target="_blank" class="sql-footer-icon fa fa-github" aria-hidden="true" style="float:right;"></a>
      -->
    </div>

           
</footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.6.0/clipboard.min.js" type="text/javascript"></script>
<script src="https://use.fontawesome.com/c7b2a63f93.js"></script>
<script src="/assets/scripts/prism.js" type="text/javascript"></script>
<script src="/assets/scripts/steps.js" type="text/javascript"></script>
<script>
  ((window.gitter = {}).chat = {}).options = {
    room: 'Microsoft/mssql-developers'
  };
</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>
  </body>

</html>
