<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="shortcut icon" type="image/png" href="https://upload.wikimedia.org/wikipedia/commons/thumb/4/44/Microsoft_logo.svg/2000px-Microsoft_logo.svg.png">

  <title>
    
      Node.js Windows
    
  </title>
  <meta name="description" content="Get started with SQL Server on macOS, Linux, and Windows.">
  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="http://localhost:4000/node/windows/step/3">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-62780441-15', 'auto');
  ga('send', 'pageview');
  $(document).ready(function() {
      $("code").bind({
          copy: function(event) {
              ga("send", "event", {
                  eventCategory: window.location.pathname,
                  eventAction: "copy_code"
              });
         console.log("Copy");

          }, 

          cut: function(event) {
              ga("send", "event", {
                  eventCategory: window.location.pathname,
                  eventAction: "copy_code"
              });
          }
      })

      $("a").click(function(event) {
          ga("send", "event", {
              eventCategory: window.location.pathname,
              eventAction: "click_link",
              eventLabel: event.target.href
          });
      })
  });  
  </script>



</head>


  <body>

    <header class="sql-header sql-header--empty" role="banner">
    <div class="sql-header-content">
      <img class="sql-header-micro" src="/assets/images/micro-logo.png" alt="Microsoft logo">
      
        <div class="sql-menutop">
          <a class="sql-menutop-link" href="/">Get started with SQL Server</a>
          <div>
            
              
              

              <div class="sql-menutop-sub ">
                  
                    
                      
                      

                        
                          <span class="sql-menutop-link">C# </span>
                        

                        
                    
                      
                      

                        

                        
                          <div class="sql-menutop-items">
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/csharp/mac" 
                                target="_self">
                                macOS
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/csharp/rhel" 
                                target="_self">
                                RHEL
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/csharp/ubuntu" 
                                target="_self">
                                Ubuntu
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/csharp/windows" 
                                target="_self">
                                Windows
                                
                              </a>
                            
                          </div>
                        
                    
                  
              </div>
            
              
              

              <div class="sql-menutop-sub ">
                  
                    
                      
                      

                        
                          <span class="sql-menutop-link">Java </span>
                        

                        
                    
                      
                      

                        

                        
                          <div class="sql-menutop-items">
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/java/mac" 
                                target="_self">
                                macOS
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/java/rhel" 
                                target="_self">
                                RHEL
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/java/ubuntu" 
                                target="_self">
                                Ubuntu
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/java/sles" 
                                target="_self">
                                SLES
                                
                                  <i class="sql-new"></i>
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/java/windows" 
                                target="_self">
                                Windows
                                
                              </a>
                            
                          </div>
                        
                    
                  
              </div>
            
              
              

              <div class="sql-menutop-sub  is-active ">
                  
                    
                      
                      

                        
                          <span class="sql-menutop-link">Node.js </span>
                        

                        
                    
                      
                      

                        

                        
                          <div class="sql-menutop-items">
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/node/mac" 
                                target="_self">
                                macOS
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/node/rhel" 
                                target="_self">
                                RHEL
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/node/ubuntu" 
                                target="_self">
                                Ubuntu
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/node/sles" 
                                target="_self">
                                SLES
                                
                                  <i class="sql-new"></i>
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item  is-active " 
                                href="/node/windows" 
                                target="_self">
                                Windows
                                
                              </a>
                            
                          </div>
                        
                    
                  
              </div>
            
              
              

              <div class="sql-menutop-sub ">
                  
                    
                      
                      

                        
                          <span class="sql-menutop-link">PHP </span>
                        

                        
                    
                      
                      

                        

                        
                          <div class="sql-menutop-items">
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/php/mac" 
                                target="_self">
                                macOS
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/php/rhel" 
                                target="_self">
                                RHEL
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/php/ubuntu" 
                                target="_self">
                                Ubuntu
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/php/sles" 
                                target="_self">
                                SLES
                                
                                  <i class="sql-new"></i>
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/php/windows" 
                                target="_self">
                                Windows
                                
                              </a>
                            
                          </div>
                        
                    
                  
              </div>
            
              
              

              <div class="sql-menutop-sub ">
                  
                    
                      
                      

                        
                          <span class="sql-menutop-link">Python </span>
                        

                        
                    
                      
                      

                        

                        
                          <div class="sql-menutop-items">
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/python/mac" 
                                target="_self">
                                macOS
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/python/rhel" 
                                target="_self">
                                RHEL
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/python/ubuntu" 
                                target="_self">
                                Ubuntu
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/python/sles" 
                                target="_self">
                                SLES
                                
                                  <i class="sql-new"></i>
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/python/windows" 
                                target="_self">
                                Windows
                                
                              </a>
                            
                          </div>
                        
                    
                  
              </div>
            
              
              

              <div class="sql-menutop-sub ">
                  
                    
                      
                      

                        
                          <span class="sql-menutop-link">Ruby </span>
                        

                        
                    
                      
                      

                        

                        
                          <div class="sql-menutop-items">
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/ruby/mac" 
                                target="_self">
                                macOS
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/ruby/rhel" 
                                target="_self">
                                RHEL
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/ruby/ubuntu" 
                                target="_self">
                                Ubuntu
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/ruby/sles" 
                                target="_self">
                                SLES
                                
                                  <i class="sql-new"></i>
                                
                              </a>
                            
                              
                              
                              

                              <a class="sql-menutop-item " 
                                href="/ruby/windows" 
                                target="_self">
                                Windows
                                
                              </a>
                            
                          </div>
                        
                    
                  
              </div>
            
          </div>
        </div>

      
</header>


    <main class="sql-main" aria-label="Content">
      <div class="u-wrapper">
        <article class="sql-page_steps">

  
    
    
    

    <h1 class="sql-page_steps-hero">
      Create Node.js apps using SQL Server on Windows
    </h1>

    <header class="sql-page_steps-steps js-stepsheader">
      
        
        

        <div class="sql-page_steps-step">
          
            <a class="sql-page_steps-link "
               href="/node/windows"
               target="_self">
               <span class="sql-page_steps-number">1</span>
               Set up your environment
              </a>
          
        </div>
      
        
        

        <div class="sql-page_steps-step">
          
            <a class="sql-page_steps-link "
               href="/node/windows/step/2"
               target="_self">
               <span class="sql-page_steps-number">2</span>
               Create Node.js application with SQL server
            </a>
          
        </div>
      
        
        

        <div class="sql-page_steps-step">
          
            <a class="sql-page_steps-link  sql-page_steps-link--active "
               href="/node/windows/step/3"
               target="_self">
               <span class="sql-page_steps-number">3</span>
               Make your Node.js app up to 100x faster
            </a>
          
        </div>
      
    </header>
  

  <div class="sql-page_steps-loading js-loading">
    <p></p>
    <p></p>
    <p></p>
    <p></p>
    <div></div>
    <div></div>
    <p></p>
    <div></div>
    <div></div>
    <p></p>
    <div></div>
    <div></div>
    <div></div>
    <div></div>
    <p></p>
    <p></p>
    <div></div>
    <div></div>
    <div></div>
    <p></p>
    <div></div>
    <div></div>
    <p></p>
    <p></p>
    <div></div>
    <div></div>
    
  </div>

  <div class="js-steps is-hidden">
    <blockquote>
  <p>In this section we will show you a simple example of Columnstore Indexes and how they can improve data processing speeds. Columnstore Indexes can achieve up to 100x better performance on analytical workloads and up to 10x better data compression than traditional rowstore indexes.</p>
</blockquote>

<h2 id="step-31-create-a-new-table-with-5-million-using-sqlcmd">Step 3.1 Create a new table with 5 million using sqlcmd</h2>

<p>Change to your home directory and create a folder for your project.</p>

<div class="language-terminal highlighter-rouge"><pre class="highlight"><code>cd ~/
mkdir SqlServerColumnstoreSample
cd SqlServerColumnstoreSample
</code></pre>
</div>

<p>Using your favorite text editor, create a new file called CreateSampleTable.sql in the folder SqlServerColumnstoreSample. Paste the T-SQL code below into your new SQL file. Save and close the file.</p>

<pre><code class="language-SQL">sqlcmd -S localhost -U sa -P your_password -d SampleDB -t 60000 -Q "WITH a AS (SELECT * FROM (VALUES(1),(2),(3),(4),(5),(6),(7),(8),(9),(10)) AS a(a))
SELECT TOP(5000000)
ROW_NUMBER() OVER (ORDER BY a.a) AS OrderItemId
,a.a + b.a + c.a + d.a + e.a + f.a + g.a + h.a AS OrderId
,a.a * 10 AS Price
,CONCAT(a.a, N' ', b.a, N' ', c.a, N' ', d.a, N' ', e.a, N' ', f.a, N' ', g.a, N' ', h.a) AS ProductName
INTO Table_with_5M_rows
FROM a, a AS b, a AS c, a AS d, a AS e, a AS f, a AS g, a AS h;"
</code></pre>
<p>Connect to the database using sqlcmd and run the SQL script to create the table with 5 million rows. This may take a few minutes to run.</p>

<div class="language-terminal highlighter-rouge"><pre class="highlight"><code>  sqlcmd -S localhost -U sa -P your_password -d SampleDB -i ./CreateSampleTable.sql
</code></pre>
</div>

<h2 id="step-32-create-a-nodejs-that-queries-this-tables-and-measures-the-time-taken">Step 3.2 Create a Node.js that queries this tables and measures the time taken</h2>

<p>In your project folder, initialize Node dependencies.</p>

<div class="language-terminal highlighter-rouge"><pre class="highlight"><code>npm init -y
npm install tedious
npm install node-uuid
npm install async
</code></pre>
</div>
<p>Using you favorite text editor, create a file called columnstore.js in the SqlServerColumnstoreSample folder.</p>

<div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">Connection</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'tedious'</span><span class="p">).</span><span class="nx">Connection</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">Request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'tedious'</span><span class="p">).</span><span class="nx">Request</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">uuid</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'node-uuid'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">async</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'async'</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">userName</span><span class="p">:</span> <span class="s1">'sa'</span><span class="p">,</span>
    <span class="na">password</span><span class="p">:</span> <span class="s1">'your_password'</span><span class="p">,</span>
    <span class="na">server</span><span class="p">:</span> <span class="s1">'localhost'</span><span class="p">,</span>
    <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">database</span><span class="p">:</span> <span class="s1">'SampleDB'</span>
    <span class="p">}</span>
    <span class="c1">// When you connect to Azure SQL Database, you need these next options.</span>
    <span class="c1">//options: {encrypt: true, database: 'yourDatabase'}</span>
<span class="p">};</span>


<span class="kd">var</span> <span class="nx">connection</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Connection</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">exec</span><span class="p">(</span><span class="nx">sql</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">timerName</span> <span class="o">=</span> <span class="s2">"QueryTime"</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Request</span><span class="p">(</span><span class="nx">sql</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">});</span>
    <span class="nx">request</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'doneProc'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">rowCount</span><span class="p">,</span> <span class="nx">more</span><span class="p">,</span> <span class="nx">rows</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">more</span><span class="p">){</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">timeEnd</span><span class="p">(</span><span class="nx">timerName</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">});</span>
    <span class="nx">request</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'row'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">columns</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">columns</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">column</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Sum: "</span> <span class="o">+</span>  <span class="nx">column</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
        <span class="p">});</span>
    <span class="p">});</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">time</span><span class="p">(</span><span class="nx">timerName</span><span class="p">);</span>
    <span class="nx">connection</span><span class="p">.</span><span class="nx">execSql</span><span class="p">(</span><span class="nx">request</span><span class="p">);</span>
<span class="p">}</span>
<span class="c1">// Open connection and execute query</span>
<span class="nx">connection</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'connect'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">async</span><span class="p">.</span><span class="nx">waterfall</span><span class="p">([</span>
        <span class="kd">function</span><span class="p">(){</span>
            <span class="nx">exec</span><span class="p">(</span><span class="s1">'SELECT SUM(Price) FROM Table_with_5M_rows'</span><span class="p">);</span>
        <span class="p">},</span>
    <span class="p">]);</span>
<span class="p">});</span>
</code></pre>
</div>

<h2 id="step-33-measure-how-long-it-takes-to-run-the-query">Step 3.3 Measure how long it takes to run the query</h2>

<p>Run your Node.js app from the terminal.</p>

<div class="language-terminal highlighter-rouge"><pre class="highlight"><code>  node columnstore.js
</code></pre>
</div>

<pre><code class="language-results">Sum: 50000000
QueryTime: 363ms
</code></pre>

<h2 id="step-34-add-a-columnstore-index-to-your-table">Step 3.4 Add a columnstore index to your table.</h2>

<div class="language-terminal highlighter-rouge"><pre class="highlight"><code>sqlcmd -S localhost -U sa -P your_password -d SampleDB -Q "CREATE CLUSTERED COLUMNSTORE INDEX Columnstoreindex ON Table_with_5M_rows;"
</code></pre>
</div>

<h2 id="step-35-re-run-the-columnstorejs-script-and-notice-how-long-the-query-took-to-complete-this-time">Step 3.5 Re-run the columnstore.js script and notice how long the query took to complete this time.</h2>

<div class="language-terminal highlighter-rouge"><pre class="highlight"><code>  node columnstore.js
</code></pre>
</div>

<pre><code class="language-results">Sum: 50000000
QueryTime: 5ms
</code></pre>

<blockquote>
  <p>Congrats you just made your Node.js app faster using Columnstore Indexes!</p>
</blockquote>

  </div>

  
    
    

          
            <a class="sql-page_steps-next" href="https://github.com/tediousjs/tedious">Check out the Node.js Driver Tedious on GitHub</a>
          

      <div class="sql-resources">
    <header class="sql-resources-header">
        <h3 class="sql-resources-title">
            To get general documentations
        </h3>
        <a class="sql-resources-button"
            target="_blank"
            href="https://msdn.microsoft.com/en-us/library/mt590198(v=sql.1).aspx">
            Read the SQL Server documentation
        </a>
    </header>

    <div class="sql-resources-list">
        <h3 class="sql-resources-title">
            Check out other related tutorials and SQL Server features!
        </h3>
        
            <ul class="sql-resources-items">
                
                    
                    
                
                    
                    
                
                    
                    
                        <li class="sql-resources-item">
                            Check out what's new with <a class="sql-resources-link" href="https://channel9.msdn.com/Events/Connect/2016/160" target="_blank">SQL Server + Node.js on Channel 9</a>
                        </li>
                    
                
                    
                    
                
                    
                    
                
                    
                    
                        <li class="sql-resources-item">
                            Browse more SQL Server code samples (In-Memory, Dynamic Data Masking, R, etc.) on our <a class="sql-resources-link" href="https://github.com/Microsoft/sql-server-samples/tree/master/samples/" target="_blank">GitHub repository</a>
                        </li>
                    
                
                    
                    
                        <li class="sql-resources-item">
                            Learn more about <a class="sql-resources-link" href="https://channel9.msdn.com/Events/Connect/2016/101" target="_blank">SQL Server on Linux</a>
                        </li>
                    
                
                    
                    
                        <li class="sql-resources-item">
                            Watch more <a class="sql-resources-link" href="https://channel9.msdn.com/Events/Connect/2016" target="_blank">Connect(); event videos</a>
                        </li>
                    
                
                    
                    
                        <li class="sql-resources-item">
                            Browse our <a class="sql-resources-link" href="https://technet.microsoft.com/en-us/virtuallabs" target="_blank">Virtual Labs Gallery</a>
                        </li>
                    
                
            </ul>
      
    </div>
</div>
    
  

  <div class="sql-questions">
    <h2 class="sql-questions-title">
        Have Questions?
    </h2>
    <p class="sql-questions-text">
        Happy to help! You can find us on <a href="https://github.com/Microsoft/sql-server-samples/tree/master/samples/tutorials" target="_blank">GitHub</a>, <a href="https://social.msdn.microsoft.com/Forums/en-US/home target="_blank"">MSDN Forums</a>, and StackOverflow. We also monitor the <a href="https://twitter.com/search?q=%23SQLServerDev&amp;src=typd" target="_blank">#SQLServerDev</a> hashtag on Twitter.
    </p>
</div>

  
      <footer class="sql-disqus">
        

      </footer>
  
</article>

      </div>
    </main>

    <footer class="sql-footer">
  




    <div class="sql-footer-copy">
        <a class="sql-footer-link" href="https://go.microsoft.com/?linkid=2028325">Contact us</a> | 
        <a class="sql-footer-link" href="https://go.microsoft.com/fwlink/?LinkId=521839">Privacy & cookies</a> | 
        <a class="sql-footer-link" href="https://go.microsoft.com/fwlink/?LinkID=206977">Terms of use</a> | 
        <a class="sql-footer-link" href="https://www.microsoft.com/trademarks">Trademarks</a> | 
        <a class="sql-footer-link" href="https://choice.microsoft.com/">About our ads</a> | 
        © 2017 Microsoft 
      <!--
        <a href="#" target="_blank" class="sql-footer-icon fa fa-twitter" aria-hidden="true" style="float:right;"></a>
        <a href="#" target="_blank" class="sql-footer-icon fa fa-github" aria-hidden="true" style="float:right;"></a>
      -->
    </div>

           
</footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.6.0/clipboard.min.js" type="text/javascript"></script>
<script src="https://use.fontawesome.com/c7b2a63f93.js"></script>
<script src="/assets/scripts/prism.js" type="text/javascript"></script>
<script src="/assets/scripts/steps.js" type="text/javascript"></script>
<script>
  ((window.gitter = {}).chat = {}).options = {
    room: 'Microsoft/mssql-developers'
  };
</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>
  </body>

</html>
